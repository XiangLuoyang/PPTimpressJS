# 城市轨道交通客流出行可视化技术


## 第三章

```
  城市轨道交通网络客流分析可视化，基于三个维度来讲：1.基于类别分布；2.基于时间维度；3.基于空间维度
```
### 基于类别分布
  本节一共探讨了轨道交通九种不同的分析方向引出的九种不同的图标选择方式
  1. 各行政区轨道进站客流总量`排行榜`
  2. 各轨道线路日均进站量及日均客运量`排名`
  3. 轨道站点高峰小时内进站客流`变化趋势`折线图
  4. 轨道典型站点客流进/出站`流量`金字塔图/漏斗图
  5. 轨道站点日均客运量`比重`分布南丁格尔玫瑰图
  6. 轨道站点`流量流向`分布和弦图
  7. 轨道站点日均`客流量`分布矩阵树图
  8. 各功能区轨道线路`流量极差`分布气泡图
  9. 轨道线路`客流OD`分布桑基图

注：上面几个顺序按照下面那段话讲的顺序改改会不会更好？

这九张图是怎么来的？ 当我们在这里画一条线作为交通线路，上面画一个圈作为站点。我们可以轻易看出有以下活动：进站，出站。加上时间这个变量，我们可以很直观的知道需要作出‘3’这张图。接着，在这条线上多加几个圆圈站点，每个点依旧拥有以下活动：进站和出站，数据列出后，最能直观的表示流量的大小排名的就是‘4’。与之相似的，若要表示准确的所占比重的关系，则可采用‘5’来统计数据。随着这条线路上圆圈站点的增多，进出站的频率也增加，这时候我们便有了一个新的需求，多少人在哪里进站，在哪里出站，便有了‘6’。然后我们选中其中一个圆圈站点，再画上一条线路，这个站点就成了一个换乘站，此时除了‘进站’、‘出站’的活动以外，增加了两个‘换入’与‘换出’。反映在图上，我们可以比较多条线路的同一指标的对比(如日均进站量和日均客运量)，就是我们的‘1’。同时，如上所述，‘6’用来描述单条线路的上下客的关系，当这种关系体现在多条线路的换乘关系的时候，就出现了‘9’。按照这个思路继续走下去，将整个行政区域乃至整个城市的交通线路补齐时，思考的角度变得更大后，就有了‘1’和‘7’这样的基于整个城市的数据展示需求。有时候根据需要，也会展示类似‘流量极差’这样的数据。

上面讲的是基于类别分布的考虑需要收集的数据类型，在用图表将他们可视化的时候，我们就会面临一个如何选择的问题。图表的选择没有固定的范式，但有灵活的套路。在上面我已经把这九个图的关键字用特殊字体标注出。从制图的目的来说，大致可以把图标分作两种类型，`无方向图`和`有方向图`。这么分是为了区分作图是为了突出某一指标的高低强弱（无向图），还是为了突出多个元素之间的联系及关系强弱（有向图）。典型的关键词，诸如‘排行、排名’或者其他功能为排名与纯比较高低的图，可以采用柱形图、环形图、金字塔图及漏斗图。书中采用的例子是‘1’、‘2’采用了柱形图和环形图，‘4’采用了金字塔图和漏斗图。但在实际的开发分析中，也是可以互相替代的。对于要体现‘趋势’类的图表，如‘3’，则一般会利用折线图来体现这个特点，当数据量变得特别大的时候，还要考虑将折线图变为散点图以求更加简洁和清爽。比起折线图，散点图不仅能更好地展示多组数据，也能利用面积、颜色的不同升级为气泡图展示更加丰富的内涵，如‘8’，气泡的横纵坐标分别表示为线路名称和流量，颜色则能表示为功能区类型，大小则表示差值。当你的数据量不小，想表达的数据内涵也挺多的时候，可以选择这种气泡图。

### 基于时间维度
基于时间维度的轨道交通客流可视化，主要起的是一个对交通的实时监控作用。
基于时间的趋势变化图，正如上面所说，一般会考虑使用折线图。在基于时间维度的轨道交通客流可视化的制图过程中，大多数情况也能用折线图解决。这里介绍几种同样适用于描述基于时间变化的趋势图。

首先，让我们来看一下，基于时间维度的轨道交通客流可视化，具体有哪些类型的数据值得我们去描述：
1. 轨道进/出/换乘客流量时变特性对比分布散点图
2. 轨道交通客流流向时变特性条形堆叠图
3. 轨道客流时变特征事件河流图
4. 轨道交通刷卡数据异常值检测
5. 轨道交通小时客流量周边特性分布像素图

这些类型的数据，就如之前所说，都能用折线图来描述。不存在一定要某种图表来替代它的情况，但是为了避免过于单一，还是介绍其他几种表示时间变化趋势的图表：
1. 条形堆叠图，其实就是横着摆折线图
2. 河流图（不太适合断断续续频繁出现数值为0的数据）
3. 像素图（github上的那个）

### 基于空间维度
基于空间维度的轨道交通客流可视化，主要为了表示以下几种类型的数据：
1. 轨道进站量与换乘量的空间比例分布
2. 公共交通客流
3. 轨道站点客流

书中给我们提供了三个有意思的图例
1. 时钟图（书上没有给出明确的名字，我猜的）
2. 拓扑结构图
3. 三维空间分布喷泉图

这三者对作图的数据类型不作要求，一般情况下都可以用，但是应该考虑以下几点:有多少维度，是否有负值，真实地图是否重要；
如果要表示一个站点的多个信息，用时钟图
如果对真实地点没有要求，可以考虑拓扑结构图
如果加入了时间变量，应该考虑用三维空间分布喷泉图